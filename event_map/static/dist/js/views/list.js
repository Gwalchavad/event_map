define("jade!views/../../templates/event_list",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push("<style>#event_list li{\n   height: "+escape(null==(interp=height)?"":interp)+'px\n}\n</style><div id="event_list_top_date" class="row-fluid top"><div id="topMonthLetter" class="span2 top_text"></div><div class="span8"><div style="height: 60px;" class="row-fluid"><div id="topWeekLetter" style="text-align: center;" class="span6"><div style="display: inline-block;"><span id="day_0">S</span><span id="day_1">M</span><span id="day_2">T</span><span id="day_3">W</span><span id="day_4">T</span><span id="day_5">F</span><span id="day_6">S</span></div></div><div id="topYear" style="text-align: center;" class="span4 top_text"></div></div></div></div><div id="EventsListView" class="replace overflow setheightWithTop"><div class="row-fluid"><div class="span1"><div class="row-fluid"><div class="span5"><ul id="event_list_month"></ul></div><div class="span5"><ul id="event_list_day"></ul></div></div></div><div class="span9"><ul id="event_list"></ul></div></div></div>')}return buf.join("")}}),define("jade!views/../../templates/event_list_empty",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{})buf.push('<div id="NoEvent" class="row-fluid top"><div style="text-align: center;" class="span10 top_text">NO EVENTS</div><div><div id="EventsListView" class="replace overflow setheightWithTop"><ul id="event_list"></ul></div></div></div>');return buf.join("")}}),define("jade!views/../../templates/item_open",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="openIndt">[-]</div><div class="list_item_width"><div class="list_item_content">'+escape(null==(interp=start_time)?"":interp)+" - "+escape(null==(interp=end_time)?"":interp)+"<a"),buf.push(attrs({href:"#/event/"+slug},{href:!0})),buf.push(">&nbsp;"+escape(null==(interp=title)?"":interp)+"&nbsp;</a>| "+escape(null==(interp=content)?"":interp)+"</div></div>")}return buf.join("")}}),define("jade!views/../../templates/EventClosedPartial",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;(function(){if("number"==typeof events.length)for(var e=0,t=events.length;t>e;e++){var i=events[e];if(buf.push("<li"),buf.push(attrs({"data-id":""+i.slug,id:"event_"+i.slug,"data-date":""+i.start_datetime._i,"class":"event_item"},{"data-id":!0,id:!0,"data-date":!0})),buf.push('><div class="list_item_container"><div style="" class="openIndt">[+]</div><div class="list_item_width"><div class="list_item_content">'),i.complete){buf.push(""+escape(null==(interp=i.start_time)?"":interp)+" - "+escape(null==(interp=i.end_time)?"":interp)+"&nbsp;<a"),buf.push(attrs({href:"#/event/"+i.slug},{href:!0})),buf.push(">");var s=i.titleClose;buf.push(escape(null==s?"":s)),buf.push("</a>")}else{buf.push(""+escape(null==(interp=i.start_time)?"":interp)+" - "+escape(null==(interp=i.end_time)?"":interp)+"&nbsp;<a"),buf.push(attrs({href:"#/event/"+i.slug},{href:!0})),buf.push(">");var s=i.titleClose;buf.push(escape(null==s?"":s)),buf.push("</a>")}buf.push("</div></div></div></li>")}else for(var e in events)if(events.hasOwnProperty(e)){var i=events[e];if(buf.push("<li"),buf.push(attrs({"data-id":""+i.slug,id:"event_"+i.slug,"data-date":""+i.start_datetime._i,"class":"event_item"},{"data-id":!0,id:!0,"data-date":!0})),buf.push('><div class="list_item_container"><div style="" class="openIndt">[+]</div><div class="list_item_width"><div class="list_item_content">'),i.complete){buf.push(""+escape(null==(interp=i.start_time)?"":interp)+" - "+escape(null==(interp=i.end_time)?"":interp)+"&nbsp;<a"),buf.push(attrs({href:"#/event/"+i.slug},{href:!0})),buf.push(">");var s=i.titleClose;buf.push(escape(null==s?"":s)),buf.push("</a>")}else{buf.push(""+escape(null==(interp=i.start_time)?"":interp)+" - "+escape(null==(interp=i.end_time)?"":interp)+"&nbsp;<a"),buf.push(attrs({href:"#/event/"+i.slug},{href:!0})),buf.push(">");var s=i.titleClose;buf.push(escape(null==s?"":s)),buf.push("</a>")}buf.push("</div></div></div></li>")}}).call(this)}return buf.join("")}}),define("jade!views/../../templates/liMonths",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;(function(){if("number"==typeof months.length)for(var e=0,t=months.length;t>e;e++){var i=months[e];buf.push("<li"),buf.push(attrs({id:"month_"+i.month+"_"+i.year,style:"height:"+i.height+"px"},{id:!0,style:!0})),buf.push('><div class="rot-90 verticalMonth">'+escape(null==(interp=i.letter)?"":interp)+"</div></li>")}else for(var e in months)if(months.hasOwnProperty(e)){var i=months[e];buf.push("<li"),buf.push(attrs({id:"month_"+i.month+"_"+i.year,style:"height:"+i.height+"px"},{id:!0,style:!0})),buf.push('><div class="rot-90 verticalMonth">'+escape(null==(interp=i.letter)?"":interp)+"</div></li>")}}).call(this)}return buf.join("")}}),define("jade!views/../../templates/liDays",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;(function(){if("number"==typeof days.length)for(var e=0,t=days.length;t>e;e++){var i=days[e];buf.push("<li"),buf.push(attrs({id:"day_"+i.day+"_"+i.month+"_"+i.year,style:"height:"+i.height+"px"},{id:!0,style:!0})),buf.push(">"+escape(null==(interp=i.day)?"":interp)+"</li>")}else for(var e in days)if(days.hasOwnProperty(e)){var i=days[e];buf.push("<li"),buf.push(attrs({id:"day_"+i.day+"_"+i.month+"_"+i.year,style:"height:"+i.height+"px"},{id:!0,style:!0})),buf.push(">"+escape(null==(interp=i.day)?"":interp)+"</li>")}}).call(this)}return buf.join("")}}),define("jade!views/../../templates/popup",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push("<span"),buf.push(attrs({id:"popup_"+id},{id:!0})),buf.push("><h3><a"),buf.push(attrs({href:"/#event/"+slug},{href:!0})),buf.push(">");var __val__=title;buf.push(escape(null==__val__?"":__val__)),buf.push("</a><br/>"+escape(null==(interp=start_time)?"":interp)+"-"+escape(null==(interp=end_time)?"":interp)+"<br/><a"),buf.push(attrs({href:""+direction_url,target:"_blank","class":"popupAddress btn btn-info btn-small"},{href:!0,target:!0})),buf.push(">Directions</a></h3></span>")}return buf.join("")}}),define("views/list",["jquery","leaflet","underscore","backbone","moment","utils","views/map","jade!../../templates/event_list","jade!../../templates/event_list_empty","jade!../../templates/item_open","jade!../../templates/EventClosedPartial","jade!../../templates/liMonths","jade!../../templates/liDays","jade!../../templates/popup"],function(e,t,i,s,n,r,a,o,l,d,h,c,u,p){var f=s.View.extend({tagName:"div",className:"span4",id:"",colorRange:240,numOfFades:6,height:40,openHeight:38,nowFound:!1,colorEvents:!0,_markers:[],_eventsInView:[],_eventsViewed:[],render_var:{pre_current_date:{date:new Date},current_date:{date:new Date}},forward_lock:!1,backward_lock:!1,events:{"click .event_item":"onClick","mouseenter .event_item":"onMouseenter","mouseleave .event_item":"onMouseleave"},initialize:function(e){this.constructor.__super__.initialize.apply(this,[e]),this.model.on("add",this.onAdd,this),a.map.on("popupopen",this.onPopupOpen),a.map.on("locationfound",this.onLocationFound,this),this.baseFragment=s.history.fragment.split("?")[0]},onMarkerClick:function(t){this.eventItemOpen(t.target.options.modelID),e(t.target._icon.children).hasClass("viewing")||this.scrollToId(t.target.options.modelID)},onPopupOpen:function(t){e(t.popup._source._icon).find(".circleMarker").show(),e(t.popup._source._icon).find(".layer1").attr("transform","scale(1.2) translate(-1, -3)")},onScroll:function(t){var i=t.data,s=60;i.scrollPosition=e("#EventsListView").scrollTop(),s>=i.scrollPosition?t.data.backFetch(t.data):e("#EventsListView")[0].scrollHeight-i.scrollPosition<e("#EventsListView").outerHeight()+s&&i.forwardFetch(i),t.data.genarateColorsAndMonths(),t.data.setMonthSideBarPosition()},deScroll:i.debounce(function(e){var t=e.data;t.onScroll(e)},5),backFetch:function(t){var i=t?t:this;i.backward_lock||(i.backward_lock=!0,i.model.rfetch({successCallback:function(t){if(!i.nowFound){var s=i.renderNow();-1===s&&e("#EventsListView").scrollTop(e("#EventsListView").height())}if(i.searchDateBelow)i.gotoDate(i.options.date)&&(i.searchDateAbove=!1),i.searchDateBelow=!1;else{var n=i.scrollPosition+t.length*i.height;e("#EventsListView").scrollTop(n)}i.genarateColorsAndMonths(!0),i.backward_lock=!1}}))},forwardFetch:function(e){var t=e?e:this;t.forward_lock||(t.forward_lock=!0,t.model.ffetch({successCallback:function(){t.nowFound||t.renderNow(),t.searchDateAbove&&(t.gotoDate(t.options.date)&&(t.searchDateBelow=!1),t.searchDateAbove=!1),t.genarateColorsAndMonths(!0),t.forward_lock=!1}}))},onAdd:function(i){var s,n=i.get("location_point"),r=this.model.indexOf(i),o=i.get("start_datetime").format("h:mm A"),l=i.get("end_datetime").format("h:mm A");if(i.set("start_time",o),i.set("end_time",l),n){s="https://www.google.com/maps?daddr="+n.coordinates[1]+","+n.coordinates[0],a.currentPos&&(s+="&saddr="+a.currentPos.lat+","+a.currentPos.lng),i.set("direction_url",s);var d=t.divIcon({className:"icon",html:"<div class='icon-event' id='icon-"+i.get("slug")+"'></div>",iconAnchor:[9,23],iconSize:[24,30],popupAnchor:[4,-10]}),h=i.get("location_point"),c=t.marker([h.coordinates[1],h.coordinates[0]],{icon:d,modelID:i.get("slug")});c.bindPopup(p(i.toJSON())),a.group.addLayer(c),c.on("click",this.onMarkerClick,this),this._markers[i.get("slug")]=c,this.getMarkerById(i.get("slug")).html(e("#svg svg").clone()).addClass("hidden")}this.renderEvent(r,i)},onLocationFound:function(t){this._markers.forEach(function(i){var s=e(i._popup._content),n=s.find(".popupAddress").attr("href");n=r.updateURLParameter(n,"saddr",t.latlng.toUrlString()),s.find(".popupAddress").attr("href",n),i._popup._content=s.prop("outerHTML")})},onClick:function(t){var i=t.currentTarget.id.replace(/event_/,""),s=this._markers[i];e(t.currentTarget).hasClass("open")?(this.eventItemClose(i),s&&s.closePopup()):(this.eventItemOpen(i),s&&s.openPopup())},onMouseenter:function(t){if(!e(t.currentTarget).hasClass("open")){var i=t.currentTarget.id.replace(/event_/,"");this._markers[i]&&(this.getMarkerById(i).parent().css("margin-left",-11).css("margin-top",-27).find(".layer1").attr("transform","scale(1.2) translate(-1, -3)"),this._markers[i].setZIndexOffset(200))}},onMouseleave:function(t){if(!e(t.currentTarget).hasClass("open")){var i=t.currentTarget.id.replace(/event_/,"");this._markers[i]&&(e("#icon-"+i).parent().css("margin-left",-9).css("margin-top",-23).find(".layer1").attr("transform","scale(1)"),this._markers[i].setZIndexOffset(10))}},eventItemOpen:function(t){var s=e("#event_"+t);if(!s.hasClass("open")){var n=this.model.get(t);s.addClass("open").height(this.height+this.openHeight).find(".list_item_container").html(d(n.toJSON()));var r=i.bind(function(e,t){return t+this.openHeight},this);this.getMonthLiById(t).height(r),this.getDayLiById(t).height(r),this.getMarkerById(t)&&this._markers[t].setZIndexOffset(100)}},eventItemClose:function(t){e("#icon-"+t).parent().css("margin-left",-9).css("margin-top",-23).find(".layer1").attr("transform","scale(1)").find(".circleMarker").hide(),e("#event_"+t).height(this.height).removeClass("open");var s=i.bind(function(e,t){return t-this.openHeight},this);this.getDayLiById(t).height(s),this.getMonthLiById(t).height(s),this.setMonthSideBarPosition()},onResize:function(){0!==e("#event_list").length&&this.genarateColorsAndMonths(!0)},onClose:function(){e("#EventsListView").off("scroll."+this.cid);var t=this;i.each(i.values(this._markers),function(e,i){e.off("click"),delete t._markers[i]}),delete this._markers,this.model.off("add",this.onAdd,this)},onDOMadd:function(){this.renderNow(),this.onResize(),this.scrollPosition=e("#EventsListView").scrollTop(),this.options.date=this.options.date?n(this.options.date):n(server_time_tz.substr(0,19)),this.gotoDate(this.options.date)||(this.searchDateAbove=!0,this.searchDateBelow=!0),this.backFetch(),this.forwardFetch()},renderEvent:function(t,s){var n,r,a=s.get("start_datetime"),l=this.month2FullNameOrLetter(a,0),d=a.date(),p=a.month(),f=a.year(),v={month:p,year:f,height:this.height,letter:l},m={day:d,month:p,year:f,height:this.height},g=c({months:[v]}),_=u({days:[m]}),b=h({events:[s.toJSON()]}),w=this.$el.find("#event_list"),y=w.children().length;if(0===y)return n=o({days:[m],height:this.height}),n=e(n),n.find("#event_list_month").html(g),n.find("#event_list_day").html(_),n.find("#event_list").html(b),this.$el.html(n).find("#EventsListView").on("scroll."+this.cid,this,this.onScroll),this;y>t?r="before":(r="after",t=y-1);var k=w.children().eq(t),j=this.getMonthLi(t),L=this.getDayLi(t),E=this.$el.find("#month_"+p+"_"+f),M=this.$el.find("#day_"+d+"_"+p+"_"+f);if(k[r](b),0===E.length)j[r](g),L[r](_);else{var x=i.bind(function(e,t){return t+this.height},this);E.height(x),l=this.month2FullNameOrLetter(a,E.height()),E.children().text(l),0===M.length?L[r](_):M.height(x)}return this},renderNow:function(){var e=server_time_tz.substr(0,19),t=this.model.binarySearch(n(e),"start_datetime");if(t>0){this.colorEvents=!0,this.nowFound=!0;var i=this.getMonthLi(t),s=this.getDayLi(t);this.$el.find("#event_list li").eq(t).addClass("Now").css("border-top","4px").css("border-top-style","solid"),i.height(function(e,t){return t+4}),s.height(function(e,t){return t+4})}else-2===t?this.colorEvents=!0:-1===t&&(this.colorEvents=!1);return t},render:function(){var e=l();this.$el.html(e);var t=this;return this.model.forEach(function(e){t.onAdd(e)}),this},genarateColorsAndMonths:function(t){var s=e(document.elementFromPoint(e("#event_list").position().left+.5,e("#EventsListView").position().top+20));if(s.hasClass("event_item")&&(t||this.topVisbleEl[0]!=s[0])){var r,a=this,o=e("#event_list").children().index(e(".Now")),l=e("#event_list").children().index(s);r=o>l?o:l;var d,h=n(s.data("date")),c=(a.isListFull()?e("#EventsListView").height():e("#event_list").height())-11,u=document.elementFromPoint(e("#event_list").position().left+2,e("#EventsListView").position().top+c),p=e("#event_list").children().index(u),f=[],v=p-r;this.topVisbleEl=s,this.setMonthDay(h),this.setDay(h),this.setURL(h),e(".viewing").removeClass("viewing");for(var m=l;p>=m;m++)d=this.getMarker(m),d&&(d.addClass("viewing").removeClass("hidden").find(".svgForeground").css("fill-opacity",1).css("stroke","black"),f.push(d[0]));if(this.colorEvents){for(m=r;v+r>=m;++m)if(d=this.getMarker(m),f.push(d[0]),d){var g;g=0===v?this.colorRange:(m-r)/v*this.colorRange,this.getEventLi(m).css("background-color","hsl("+g+",100%, 50%)"),d.find(".svgForeground").css("fill","hsl("+g+",100%, 50%)"),this.setZIndex(m,10)}for(m=l-1;m>l-this.numOfFades-1&&!(o>m);m--)if(d=this.getMarker(m)){if(!i.contains(this._eventsInView,d[0]))break;f.push(d[0]),d.find(".svgForeground").css("stroke","grey").css("fill","hsl(0,100%, 50%)").css("fill-opacity",1-(l-m)/this.numOfFades),this.setZIndex(m,-10)}for(m=o>p+1?o:p+1;p+this.numOfFades+1>m;m++)if(d=this.getMarker(m)){if(!i.contains(this._eventsInView,d[0]))break;f.push(d[0]),d.find(".svgForeground").css("stroke","grey").css("fill","hsl("+this.colorRange+",100%, 50%)").css("fill-opacity",1-(m-p-1)/this.numOfFades),this.setZIndex(m,-10)}}var _=i.filter(this._eventsInView,function(e){return!i.contains(f,e)},this);_.forEach(function(t){e(t).addClass("hidden")}),this._eventsInView=f}},getEventLi:function(e){return this.$el.find("#event_list li").eq(e)},getMonthLi:function(e){var t=this.getEventLi(e),i=new Date(t.data("date")),s=i.getUTCFullYear(),n=i.getUTCMonth();return this.$el.find("#month_"+n+"_"+s)},getDayLi:function(e){var t=this.$el.find("#event_list li").eq(e),i=new Date(t.data("date")),s=i.getUTCFullYear(),n=i.getUTCMonth(),r=i.getUTCDate();return this.$el.find("#day_"+r+"_"+n+"_"+s)},getDayLiById:function(e){var t=this.model.get(e),i=t.get("start_datetime").date(),s=t.get("start_datetime").month(),n=t.get("start_datetime").year();return this.$el.find("#day_"+i+"_"+s+"_"+n)},getMonthLiById:function(e){var t=this.model.get(e),i=t.get("start_datetime").month(),s=t.get("start_datetime").year();return this.$el.find("#month_"+i+"_"+s)},getMarkerById:function(t){return e("#icon-"+t).length>0?e("#icon-"+t):!1},getMarker:function(e){var t=this.model.at(e);return t?this.getMarkerById(t.get("slug")):!1},getTopEvent:function(){return document.elementFromPoint(e("#event_list").position().left+.5,e("#EventsListView").position().top+20)},setZIndex:function(e,t){var i=this.model.at(e).get("slug");this._markers[i].setZIndexOffset(t)},setDay:function(t){var i=t.day();e(".selected_day").removeClass("selected_day"),e("#day_"+i).addClass("selected_day")},setMonthDay:function(t){var i=t.format("MMM")[0],s=t.date();e("#topMonthLetter").text(i+s),e("#topYear").text(t.year())},setURL:function(e){app.navigate(this.baseFragment+"?date="+e.format("YYYY-MM-DD"),{trigger:!1,replace:!0})},setMonthSideBarPosition:function(){var t=20,i=document.elementFromPoint(e("#event_list").position().left+.5,e("#event_list_top_date").height()),s=e(i).data("id"),n=this.model.get(s).get("start_datetime"),r=e("#month_"+n.month()+"_"+n.year()),a=r.position().top+r.height(),o=r.children().width(),l=(r.next().children().width(),r.children());if(this.current_top_month&&this.current_top_month[0]===l[0]||(e(".monthFixed").removeClass("monthFixed"),this.current_top_month&&this.current_top_month.css("top",0),this.current_top_month=l),a>e("#EventsListView").position().top+o+t)l.addClass("monthFixed").removeClass("relative").css("top",e("#EventsListView").position().top);else{var d=r.height(),h=d-o-t;0>h&&(h=0),l.addClass("relative").removeClass("monthFixed").css("top",h)}},gotoDate:function(t){var i=this.model.binarySearch(t,"start_datetime");if(0>i)return!1;var s=i*this.height;e("#EventsListView").scrollTop(s),this.setMonthSideBarPosition();var n=this.getTopEvent(),r=this.getEventLi(i);return n!=r[0]?!1:!0},scrollToId:function(t){this.scrollTo(e("#event_"+t))},scrollTo:function(t){var i=e("#EventsListView").scrollTop()-e("#EventsListView").position().top+t.position().top;e("#EventsListView").animate({scrollTop:i},700)},isListFull:function(){return e("#EventsListView").height()<e("#event_list").height()?!0:!1},month2FullNameOrLetter:function(e,t){var i=t/10;return 10>i?e.format("MMM")[0]:e.format("MMMM")}});return{EventsListView:f}}),define("jade!views/../../templates/list_info",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){var interp;buf.push('<div class="row-fluid top"><h1>'+escape(null==(interp=title)?"":interp)+'</h1></div><div id="ListOptionView" style="margin: 20px;"><p><span id="description">'+escape(null==(interp=description)?"":interp)+"</span>"),permissions.group_admin&&buf.push('<button id="editProfile" class="btn btn-link">Edit</button>'),buf.push('</p></div><div id="actions" style="margin: 20px;">'),permissions.add_event&&buf.push('<a href="#add/event" type="button" class="btn btn-large btn-block btn-primary">Add Event</a>'),buf.push('</div><div id="listOptionPanels"><div><a href="{{icalURL}}" target="_blank">Export</a></div></div>')}return buf.join("")}}),define("jade!views/../../templates/edit_profile",["jade"],function(jade){return function anonymous(locals,attrs,escape,rethrow,merge){attrs=attrs||jade.attrs,escape=escape||jade.escape,rethrow=rethrow||jade.rethrow,merge=merge||jade.merge;var buf=[];with(locals||{}){buf.push('<textarea id="description">');var __val__=description;buf.push(escape(null==__val__?"":__val__)),buf.push('</textarea><div id="Controls"><button type="button" id="Save" class="btn btn-primary">Save</button><button type="button" id="Cancel" class="btn">Cancel</button></div>')}return buf.join("")}}),define("views/list_info",["backbone","jquery","jade!../../templates/list_info","jade!../../templates/edit_profile"],function(e,t,i,s){var n=e.View.extend({tagName:"div",className:"replace span3",id:"calender",events:{"click #editProfile":"editProfile"},childrenEL:"#listOptionPanels",initialize:function(e){this.constructor.__super__.initialize.apply(this,[e])},render:function(){function e(){t.model&&t.model.get("title")==app.session.get("username")&&(t.model.set("title","MY EVENTS"),t.model.set("permissions",{group_admin:!0,add_event:!0})),t.$el.append(i(t.model.toJSON()))}var t=this;if(this.model.id){var s=this.model.fetch();s.error(function(){throw"event not found"}),s.success(function(){e()})}else e();return this},editProfile:function(){this.oldText=t("#description").text(),t("#ListOptionView").html(s({description:this.oldText})),t("#Cancel").one("click",this,this.closeEditor),t("#Save").one("click",this,this.saveProfile)},closeEditor:function(e){var t=e.data;t.$el.html(i(t.model.toJSON()))},saveProfile:function(e){var i=e.data;i.model.set("description",t("#description").val()),i.model.save(),i.closeEditor(e)}});return n});